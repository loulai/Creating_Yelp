<template id="review_template">
	<li>{{ rating }} {{ thoughts }}</li>
</template>

<% if @restaurants.any? %>

<div class='restaurant'>
	
	<% @restaurants.each do |restaurant| %>
		<h2><%= restaurant.name %></h2>
			<%= link_to "Edit #{restaurant.name}", edit_restaurant_path(restaurant)%>
			<%= link_to "Delete #{restaurant.name}", restaurant_path(restaurant), method: :delete, data: { confirm: 'Are you sure?'} %>
			<%= link_to "Review #{restaurant.name}", new_restaurant_review_path(restaurant)%>
		<h4><%= pluralize restaurant.reviews.count, 'review'%></h4>
		<h5>Average Rating: 
			<%= number_with_precision(restaurant.average_rating, precision: 1) %>
			<%= star_rating(restaurant.average_rating) %>

			<ul>
				<% restaurant.reviews.each do |review| %>
					<li><%= star_rating(review.rating) %> <%= review.thoughts%></li>
				<%end%>
			</ul>

			<%= form_for [restaurant, @review] do |f| %>

			<%= f.label :thoughts %>
			<%= f.text_area :thoughts%>

			<%= f.label :rating %>
			<%= f.select :rating, 1..5, required: true %>

			<%= f.submit 'Leave Review' %>

		<%end%>
	<%end%>

			
		</h5>
			
</div>

<% if @review.errors.any? %>
  <div id="review_error_explanation">
    <h2><%= pluralize(@review.errors.count, "error") %> prohibited this review from being saved:</h2>
    <ul>
    <% @review.errors.full_messages.each do |msg| %>
      <li><%= msg %></li>
    <% end %>
    </ul>
  </div>
<% end %>

<%else%>
	No restaurants added yet
<%end%>

<%= link_to "Create a restaurant", new_restaurant_path %>